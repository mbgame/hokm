"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[577],{8577:function(t,e,a){a.r(e),a.d(e,{default:function(){return z}});var o=a(7437),n=a(2265),r=a(5533),i=a(6547),s=a(8118),h=a(7776);let l=[{type:"spades",number:"ace",value:14},{type:"hearts",number:"ace",value:14},{type:"clubs",number:"ace",value:14},{type:"diamonds",number:"ace",value:14},{type:"spades",number:"king",value:13},{type:"hearts",number:"king",value:13},{type:"clubs",number:"king",value:13},{type:"diamonds",number:"king",value:13},{type:"spades",number:"queen",value:12},{type:"hearts",number:"queen",value:12},{type:"clubs",number:"queen",value:12},{type:"diamonds",number:"queen",value:12},{type:"spades",number:"jack",value:11},{type:"hearts",number:"jack",value:11},{type:"clubs",number:"jack",value:11},{type:"diamonds",number:"jack",value:11},{type:"spades",number:"10",value:10},{type:"hearts",number:"10",value:10},{type:"clubs",number:"10",value:10},{type:"diamonds",number:"10",value:10},{type:"spades",number:"9",value:9},{type:"hearts",number:"9",value:9},{type:"clubs",number:"9",value:9},{type:"diamonds",number:"9",value:9},{type:"spades",number:"8",value:8},{type:"hearts",number:"8",value:8},{type:"clubs",number:"8",value:8},{type:"diamonds",number:"8",value:8},{type:"spades",number:"7",value:7},{type:"hearts",number:"7",value:7},{type:"clubs",number:"7",value:7},{type:"diamonds",number:"7",value:7},{type:"spades",number:"6",value:6},{type:"hearts",number:"6",value:6},{type:"clubs",number:"6",value:6},{type:"diamonds",number:"6",value:6},{type:"spades",number:"5",value:5},{type:"hearts",number:"5",value:5},{type:"clubs",number:"5",value:5},{type:"diamonds",number:"5",value:5},{type:"spades",number:"4",value:4},{type:"hearts",number:"4",value:4},{type:"clubs",number:"4",value:4},{type:"diamonds",number:"4",value:4},{type:"spades",number:"3",value:3},{type:"hearts",number:"3",value:3},{type:"clubs",number:"3",value:3},{type:"diamonds",number:"3",value:3},{type:"spades",number:"2",value:2},{type:"hearts",number:"2",value:2},{type:"clubs",number:"2",value:2},{type:"diamonds",number:"2",value:2}],u=[{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,-6]},{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,-5]},{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,-4]},{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,-3]},{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,-2]},{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,-1]},{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,0]},{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,1]},{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,2]},{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,3]},{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,4]},{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,5]},{rotation:[-Math.PI/2,0,Math.PI/2],position:[-7,5,6]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[-6,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[-5,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[-4,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[-3,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[-2,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[-1,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[0,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[1,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[2,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[3,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[4,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[5,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[6,5,10]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,-6]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,-5]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,-4]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,-3]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,-2]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,-1]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,0]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,1]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,2]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,3]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,4]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,5]},{rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[7,5,6]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[-6,5,-10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[-5,5,-10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[-4,5,-10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[-3,5,-10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[-2,5,-10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[-1,5,-10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[0,5,-10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[1,5,-10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[2,5,-10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[3,5,-10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[4,5,-10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[5,5,-10]},{rotation:[-Math.PI/2,Math.PI,Math.PI],position:[6,5,-10]}];function c(t,e){return Math.floor(Math.random()*(e-t+1))+t}var p=a(4823),d=a(9582),P=t=>{let{type:e,number:a,width:r=10,height:i=15,position:l=[0,0,0],rotation:u=[0,0,0],scale:c=[1,1,1],shadow:P=!1,animate:M=!1,animatePos:I=[0,0,0],animateRotation:m=[0,0,0],onAnimationComplete:y,setPlayerCard:x,cardIndex:b,gameIndex:f,animationIndex:v,currentSet:g=!1}=t,j=(0,s.F)(h.TextureLoader,"/textures/cards/".concat(a,"_of_").concat(e,".png")),S=(0,s.F)(h.TextureLoader,"/textures/cards/back.png"),k=(0,n.useRef)(null),[w,C]=(0,n.useState)(M);return(0,n.useEffect)(()=>{C(M)},[M]),(0,s.C)(t=>{let{clock:e}=t;w&&(d.ZP.timeline({onComplete:y}).to(k.current.position,{duration:f?.5:.01,delay:.1,x:I[0],y:I[1],z:I[2]}),d.ZP.to(k.current.rotation,{duration:f?.5:.1,delay:.01,x:m[0],y:m[1],z:m[2]}))}),(0,o.jsxs)("mesh",{position:l,rotation:u,scale:c,ref:k,onClick:t=>{console.log(g),t.stopPropagation(),1===f&&b<=12&&!g&&(x(e,a),C(!0))},children:[(0,o.jsx)(p.JO,{args:[r/10,i/10],castShadow:P,children:(0,o.jsx)("meshPhysicalMaterial",{attach:"material",map:j,side:h.DoubleSide,clearcoat:1,clearcoatRoughness:0,metalness:0})}),(0,o.jsx)(p.JO,{args:[r/10,i/10],position:[0,0,-.01],children:(0,o.jsx)("meshPhysicalMaterial",{attach:"material",map:S,side:h.DoubleSide,clearcoat:1,clearcoatRoughness:0,metalness:0})})]})},M=a(2060),I=t=>{let{position:e=[0,5,0],angle:a=.4,intensity:r=10,castShadow:i=!1,distance:s=20,decay:h=1,penumbra:l=2,power:u=1,showHelper:c=!1}=t,p=(0,n.useRef)(null);return(0,o.jsx)(M.P,{ref:p,position:e,angle:a,intensity:r,castShadow:i,distance:s,decay:h,penumbra:l,power:u})},m=a(7871),y=t=>{let{width:e,height:a,texturePath:n,receivedShadow:r=!1,textureRepeat:i}=t,s=(0,m.m)({map:"/textures/".concat(n,"/albedo.png"),displacementMap:"/textures/".concat(n,"/height.png"),normalMap:"/textures/".concat(n,"/normal.png"),roughnessMap:"/textures/floor/roughness.png",aoMap:"/textures/".concat(n,"/ao.png")});return(0,o.jsx)("mesh",{geometry:new h.PlaneGeometry(e,a),position:[0,-2.3,0],rotation:[-Math.PI/2,0,0],receiveShadow:r,children:(0,o.jsx)("meshStandardMaterial",{...s,side:h.DoubleSide})})},x=a(8974),b=t=>{let{path:e,position:a=[0,0,0],rotation:r=[0,0,0],scale:i=[1,1,1],shadow:s=!1,receivedShadow:h=!1,onLoaded:l}=t,u=(0,n.useRef)(),{scene:c,nodes:p,materials:d}=(0,x.L)(e);return(0,n.useEffect)(()=>{c&&(u.current.scale.set(...i),u.current.position.set(...a),u.current.rotation.set(...r),c.traverse(t=>{t.isMesh&&(t.castShadow=s,t.receiveShadow=h)}),l&&l())},[c,p,d,a,r,i,s,h,l]),c?(0,o.jsx)("primitive",{ref:u,object:c,dispose:null}):null},f=t=>{let{position:e,rotation:a,scale:r,color:i,animationSpeed:h}=t,l=(0,n.useRef)(null);(0,n.useEffect)(()=>{let t=l.current;return()=>{t&&(t.scale.y=1)}},[l]);let u=0;return(0,s.C)(()=>{l.current&&(u+=h,l.current.scale.y=Math.cos(Math.PI*u)+4)}),(0,o.jsx)("group",{ref:l,position:e,rotation:a,scale:r,children:(0,o.jsxs)("mesh",{children:[(0,o.jsx)("coneGeometry",{args:[.5,.5,32]}),(0,o.jsx)("meshPhongMaterial",{color:i})]})})},v=t=>{let{helperIndex:e}=t;return(0,o.jsxs)(o.Fragment,{children:[0===e&&(0,o.jsx)(f,{position:[0,7,2],rotation:[Math.PI,0,0],scale:[1,1,1],color:"red",animationSpeed:.1}),1===e&&(0,o.jsx)(f,{position:[3,7,-5],rotation:[Math.PI,0,0],scale:[1,1,1],color:"red",animationSpeed:.1}),2===e&&(0,o.jsx)(f,{position:[0,7,-5],rotation:[Math.PI,0,0],scale:[1,1,1],color:"red",animationSpeed:.1})]})},g=a(4379);let j=["hearts","spades","clubs","diamonds"];var S=t=>{let{handleHokm:e}=t,a={hearts:(0,s.F)(h.TextureLoader,"/textures/hokm/heart.png"),spades:(0,s.F)(h.TextureLoader,"/textures/hokm/spade.png"),clubs:(0,s.F)(h.TextureLoader,"/textures/hokm/club.png"),diamonds:(0,s.F)(h.TextureLoader,"/textures/hokm/diamond.png")},r=(t,n)=>(0,o.jsxs)("mesh",{onClick:()=>e(n),position:t,rotation:[0,-Math.PI/2,0],children:[(0,o.jsx)("boxGeometry",{args:[2,.1,2]}),(0,o.jsx)("meshPhongMaterial",{color:"black",map:a[n],alphaMap:a[n],transparent:!0})]});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g.x,{color:"gold",fontSize:1,anchorX:"center",anchorY:"middle",position:[3,5,-5],rotation:[-Math.PI/2,0,3*Math.PI/2],children:"Select Hokm"}),(0,o.jsx)("group",{onPointerOver:()=>document.body.style.cursor="pointer",onPointerOut:()=>document.body.style.cursor="default",children:Object.values(j).map((t,e)=>(0,o.jsx)(n.Fragment,{children:r(e%2==0?[1,5,-3.5-1.5*e]:[-2,5,-2-1.5*e],t)},t))})]})},k=t=>{let{names:e=["player1","player2","player3","player4"],color:a="#84a02b"}=t;return(0,o.jsxs)("group",{children:[(0,o.jsx)(g.x,{color:a,fontSize:.5,anchorX:"center",anchorY:"middle",position:[-6,5,0],rotation:[-Math.PI/2,0,3*Math.PI/2],children:e[0]}),(0,o.jsx)(g.x,{color:a,fontSize:.5,anchorX:"center",anchorY:"middle",position:[0,5,9],rotation:[-Math.PI/2,0,-2*Math.PI],children:e[1]}),(0,o.jsx)(g.x,{color:a,fontSize:.5,anchorX:"center",anchorY:"middle",position:[6,5,0],rotation:[-Math.PI/2,0,Math.PI/2],children:[e[2]]}),(0,o.jsx)(g.x,{color:a,fontSize:.5,anchorX:"center",anchorY:"middle",position:[0,5,-9],rotation:[-Math.PI/2,0,3*Math.PI],children:e[3]})]})},w=t=>{let{collectCard:e,gameScore:a={player1:0,player2:0,player3:0,player4:0},color:n="#84a02b",names:r=["player1","player2","player3","player4"],title:i="Game Score",titleColor:s="green"}=t;return(0,o.jsxs)("group",{children:[(0,o.jsxs)(g.x,{color:s,fontSize:.7,anchorX:"center",anchorY:"middle",position:[-2,5,-5],rotation:[-Math.PI/2,0,-Math.PI/2],onClick:e,children:["$",i]}),(0,o.jsx)(g.x,{color:n,fontSize:.5,anchorX:"center",anchorY:"middle",position:[-3,5,-5],rotation:[-Math.PI/2,0,-Math.PI/2],onClick:e,children:"".concat(r[0]," : ").concat(a.player1)}),(0,o.jsx)(g.x,{color:n,fontSize:.5,anchorX:"center",anchorY:"middle",position:[-4,5,-5],rotation:[-Math.PI/2,0,-Math.PI/2],onClick:e,children:"".concat(r[1]," : ").concat(a.player2)}),(0,o.jsx)(g.x,{color:n,fontSize:.5,anchorX:"center",anchorY:"middle",position:[-5,5,-5],rotation:[-Math.PI/2,0,-Math.PI/2],onClick:e,children:"".concat(r[2]," : ").concat(a.player3)}),(0,o.jsx)(g.x,{color:n,fontSize:.5,anchorX:"center",anchorY:"middle",position:[-6,5,-5],rotation:[-Math.PI/2,0,-Math.PI/2],onClick:e,children:"".concat(r[3]," : ").concat(a.player4)})]})},C=t=>{let{helperIndex:e,reorderCards:a,startDealing:n,collectCard:r}=t;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g.x,{color:"#f7c815",fontSize:2,anchorX:"center",anchorY:"middle",position:[0,5,0],rotation:[-Math.PI/2,0,2*Math.PI],children:"HOKM"}),(0,o.jsx)(g.x,{color:"gray",fontSize:.7,letterSpacing:.3,anchorX:"center",anchorY:"middle",position:[0,5,1.1],rotation:[-Math.PI/2,0,2*Math.PI],children:"By MBGame"}),0===e&&(0,o.jsx)(g.x,{color:"pink",fontSize:.5,anchorX:"center",anchorY:"middle",position:[0,5,2],rotation:[-Math.PI/2,0,2*Math.PI],scale:[2,2,2],onClick:n,onPointerOver:()=>document.body.style.cursor="pointer",onPointerOut:()=>document.body.style.cursor="default",children:"Start the Game"}),2===e&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(g.x,{color:"gold",fontSize:1,anchorX:"center",anchorY:"middle",position:[0,5,-5],rotation:[-Math.PI/2,0,3*Math.PI/2],onPointerOver:()=>document.body.style.cursor="pointer",onPointerOut:()=>document.body.style.cursor="default",onClick:r,children:"Next Turn"})}),(0,o.jsx)(g.x,{color:"gold",fontSize:.5,anchorX:"center",anchorY:"middle",position:[-8.5,5,6],rotation:[-Math.PI/2,0,3*Math.PI/2],onClick:a,onPointerOver:()=>document.body.style.cursor="pointer",onPointerOut:()=>document.body.style.cursor="default",children:"Sort Cards"})]})},z=()=>{let[t,e]=n.useState(-1),[a,p]=n.useState(u),[d,M]=n.useState(u),[m,x]=n.useState(0),[f,g]=n.useState([]),[j,z]=n.useState(!1),[O,X]=n.useState([]),[Y,F]=n.useState([]),[T,L]=n.useState(""),[R,V]=n.useState(0),[E,_]=n.useState({player1:0,player2:0,player3:0,player4:0}),G=n.useMemo(()=>(function(t){for(let e=t.length-1;e>0;e--){let a=Math.floor(Math.random()*(e+1));[t[e],t[a]]=[t[a],t[e]]}return t})(l),[]),[q,D]=n.useState(G);n.useEffect(()=>{let t=[];for(let e=0;e<4;e++)t.push(q.slice(13*e,(e+1)*13));X(t),F(t)},[q]);let N=()=>{0===m&&(T?e(t+1):(t>=0&&t<4?e(t+1):4===t&&e(13),t>=13&&t<17?e(t+1):17===t&&e(26),t>=26&&t<30?e(t+1):30===t&&e(39),t>=39&&t<43?e(t+1):43===t&&e(-1)),51===t&&(x(1),e(-1)))},A=(t,o)=>{let n=[...a],r=[];o.map(t=>{r.push(q.findIndex(e=>e.type===t.type&&e.number===t.number))}),r.map((t,e)=>{n[t]={rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[4,5+e/300,3.5]}}),M(n),g(r),e(-1)},H=()=>{p(d),e(-1),setTimeout(()=>{for(let t=0;t<f.length;t++)!function(a){setTimeout(()=>{e(f[a]),0===a&&V(3)},100*t)}(t)},100)},B=(t,e,a,o)=>{let n;let r=[t,e,a,o],i=r.filter(t=>t.type===T),s=r.filter(t=>t.type!==T);if(i.length>0){let t=i.reduce((t,e)=>t.value>e.value?t:e,i[0]);n="player"+Number(r.indexOf(t)+1)}else{let t=s.reduce((t,e)=>t.value>e.value?t:e,s[0]);n="player"+Number(r.indexOf(t)+1)}return A(n,[t,e,a,o]),n},J=(t,e,a)=>{let o=t.filter(t=>t.type===a);if(o.length>0)return o.reduce((t,e)=>t.value>e.value?t:e);{let e=t.filter(t=>t.type===T);return e.length>0?e.reduce((t,e)=>t.value<e.value?t:e):t[0]}},Z=(t,a,o,n)=>{let r=O[a].findIndex(e=>e.type===t.type&&e.number===t.number);r>=0&&(setTimeout(()=>{e(13*a+r)},o),n[a]=n[a].filter(e=>e!==t))},K=(t,e)=>{z(!0);let a=[...Y],o=Y[0].find(a=>a.type===t&&a.number===e),n=J(Y[1],1,t),r=J(Y[2],2,t),i=J(Y[3],3,t);Z(n,1,1e3,a),Z(r,2,2e3,a),Z(i,3,3e3,a),setTimeout(()=>{F(a),z(!1);let t=B(o||0,n||0,r||0,i||0);_(e=>({...e,[t]:e[t]+1})),V(2)},4e3)},$=()=>{e(-1)};return n.useEffect(()=>{1===m&&(console.log("The game started!"),$(),p(Array.from({length:52},(t,e)=>({rotation:[-Math.PI/2,0,Math.PI/2*(e+1)],position:[c(-2,2),5+e/300,c(-2,2)]}))))},[m]),(0,s.C)((t,e)=>{let{camera:a}=t,o=[new h.Vector3(-15,15,15),new h.Vector3(-13,12,-5),new h.Vector3(-10,12,-5),new h.Vector3(-13,12,0)],n=[new h.Vector3(0,0,0),new h.Vector3(-8,8,-5),new h.Vector3(-5,8,-5),new h.Vector3(0,2,0)];R>=0&&R<o.length&&(a.position.lerp(o[R],.03),a.lookAt(n[R]))}),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.c,{makeDefault:!0,position:[-50,30,-50]}),(0,o.jsx)("ambientLight",{color:"white",intensity:.3}),(0,o.jsx)(I,{position:[0,15,0],intensity:150,distance:18,angle:.9,power:80}),(0,o.jsx)(I,{position:[-30,15,0],intensity:300,distance:40,angle:.6,power:400}),(0,o.jsx)(i.z,{}),(0,o.jsx)(C,{helperIndex:R,startDealing:()=>{V(1),e(0)},collectCard:H,reorderCards:()=>{D(function(t){let e=["2","3","4","5","6","7","8","9","10","jack","queen","king","ace"],a=["clubs","diamonds","hearts","spades"];return t.map(t=>t.sort((t,a)=>e.indexOf(t.number)-e.indexOf(a.number))).map(t=>t.sort((t,e)=>a.indexOf(t.type)-a.indexOf(e.type))).flat()}(O))}}),(0,o.jsx)(v,{helperIndex:R}),(0,o.jsx)(k,{}),1===R&&(0,o.jsx)(S,{handleHokm:t=>{L(t),e(0),V(3)}}),2===R&&(0,o.jsx)(w,{gameScore:E,collectCard:H}),(0,o.jsx)(y,{width:100,height:100,texturePath:"floor2",textureRepeat:[1,2],receivedShadow:!0}),(0,o.jsx)(b,{path:"/model/table/scene.gltf",scale:[28,9.3,20],position:[0,-2,0],shadow:!0}),(0,o.jsx)(b,{path:"/model/card_tray/scene.gltf",scale:[2,2,2],position:[4,4.8,5]}),q.length&&q.map((e,n)=>(0,o.jsx)(P,{type:e.type,number:e.number,width:7,height:10.5,rotation:[-Math.PI/2,Math.PI,Math.PI/2],position:[4,5+n/200,3.5],animate:t===n,onAnimationComplete:N,animateRotation:a[n].rotation,animatePos:a[n].position,gameIndex:m,animationIndex:t,cardIndex:n,setPlayerCard:K,currentSet:j},n))]})}}}]);